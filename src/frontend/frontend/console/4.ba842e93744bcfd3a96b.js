(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"1qeJ":function(t,e,o){"use strict";var i=o("NOKQ");o.n(i).a},Jc4d:function(t,e,o){},NOKQ:function(t,e,o){},ObjY:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isDataLoading},expression:"{ isLoading: isDataLoading }"}],staticStyle:{width:"100%"}},[o("div",{staticClass:"biz-pm biz-pm-index biz-create-pm"},[t.projectList.length||t.isDataLoading?[o("div",{staticClass:"biz-pm-header"},[o("div",{staticClass:"title"},[t._v("\n                    项目管理\n                ")]),t._v(" "),o("div",{staticClass:"action"},[o("bk-checkbox",{attrs:{name:"isFilterByOffline"},model:{value:t.isFilterByOffline,callback:function(e){t.isFilterByOffline=e},expression:"isFilterByOffline"}},[t._v("\n                        显示已停用项目\n                    ")]),t._v(" "),o("bk-button",{attrs:{theme:"primary","icon-right":"icon-plus"},on:{click:function(e){return t.togglePMDialog(!0)}}},[t._v("\n                        新建项目\n                    ")]),t._v(" "),o("bk-input",{staticClass:"search-input-row",attrs:{name:"searchInput",placeholder:"搜索","right-icon":"bk-icon icon-search"},on:{keyup:function(e){return t.filterProjectList(t.isFilterByOffline)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}})],1)]),t._v(" "),t.curProjectList.length?o("bk-table",{staticClass:"biz-table",attrs:{size:"medium",data:t.formatPageData,pagination:t.pageConf},on:{"page-change":t.pageChange,"page-limit-change":t.limitChange}},[o("bk-table-column",{attrs:{label:"项目名称",prop:"logo_addr",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"project-name-cell"},[e.row.logo_addr?o("span",{staticClass:"avatar",on:{click:function(o){return t.modifyLogo(e.row)}}},[o("img",{staticClass:"avatar-addr",attrs:{src:e.row.logo_addr}}),t._v(" "),o("span",{staticClass:"bg-avatar"},[t._v("编辑")])]):o("span",{staticClass:"avatar",class:["project-avatar","match-color-"+t.matchForCode(e.row.project_code)],on:{click:function(o){return t.modifyLogo(e.row)}}},[t._v("\n                                "+t._s(e.row.project_name.substr(0,1))+"\n                                "),o("span",{staticClass:"bg-avatar"},[t._v("编辑")])]),t._v(" "),o("div",{staticClass:"info"},[o("p",{staticClass:"title"},[2!==e.row.approval_status?[o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"没有操作权限"},expression:"{ content: '没有操作权限' }"}],staticClass:"bk-text-button is-disabled",attrs:{href:"javascript:void(0)",title:"没有操作权限"}},[t._v(t._s(e.row.project_name))])]:[e.row.isOfflined?o("a",{class:["bk-text-button",{"is-disabled":e.row.is_offlined}],attrs:{href:"javascript:void(0)"}},[t._v(t._s(e.row.project_name))]):o("a",{class:["bk-text-button",{"is-disabled":e.row.is_offlined}],attrs:{href:"javascript:void(0)"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.goProject(e.row.projectCode)}}},[t._v(t._s(e.row.projectName))])]],2),t._v(" "),o("time",{staticClass:"time"},[t._v(t._s(e.row.created_at))])])])]}}],null,!1,1199048823)}),t._v(" "),o("bk-table-column",{attrs:{label:"项目说明",prop:"description"}}),t._v(" "),o("bk-table-column",{attrs:{label:"创建者",prop:"creator"}}),t._v(" "),o("bk-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.approval_status?[o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"待审批，没有操作权限"},expression:"{ content: '待审批，没有操作权限' }"}],staticClass:"bk-text-button is-disabled",attrs:{href:"javascript:void(0)",title:"没有操作权限"}},[t._v("编辑")]),t._v(" "),o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"待审批，没有操作权限"},expression:"{ content: '待审批，没有操作权限' }"}],staticClass:"bk-text-button is-disabled",attrs:{href:"javascript:void(0)",title:"没有操作权限"}},[t._v("启用")]),t._v(" "),o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"待审批，没有操作权限"},expression:"{ content: '待审批，没有操作权限' }"}],staticClass:"bk-text-button is-disabled",attrs:{title:"没有操作权限"}},[t._v("用户管理")])]:3===e.row.approval_status?[o("a",{class:["bk-text-button"],attrs:{href:"javascript:void(0)"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.togglePMDialog(!0,e.row)}}},[t._v("编辑")]),t._v(" "),o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"已驳回，没有操作权限"},expression:"{ content: '已驳回，没有操作权限' }"}],staticClass:"bk-text-button is-disabled",attrs:{href:"javascript:void(0)",title:"没有操作权限"}},[t._v("启用")]),t._v(" "),o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"已驳回，没有操作权限"},expression:"{ content: '已驳回，没有操作权限' }"}],staticClass:"bk-text-button is-disabled",attrs:{href:"javascript:void(0)",title:"没有操作权限"}},[t._v("用户管理")])]:[o("a",{class:["bk-text-button",{"is-disabled":e.row.isOfflined}],attrs:{href:"javascript:void(0)"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.togglePMDialog(!0,e.row)}}},[t._v("编辑")]),t._v(" "),e.row.isOfflined?[o("a",{staticClass:"bk-text-button",attrs:{href:"javascript:void(0)"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.offlineProject(e.row)}}},[t._v("启用")])]:[o("a",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:"此功能暂未开放"},expression:"{ content: '此功能暂未开放' }"}],staticClass:"bk-text-button is-disabled",staticStyle:{margin:"0 15px"},attrs:{href:"javascript:void(0)"}},[t._v("停用")])]]]}}],null,!1,2030386060)})],1):[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDataLoading,expression:"!isDataLoading"}],staticClass:"biz-guide-box"},[!t.isFilterByOffline&&t.offlineProjectNum?o("p",{staticClass:"title"},[t._v("\n                        您有"+t._s(t.offlineProjectNum)+"个项目已经停用，请点击右上角“显示已停用项目”或新建项目\n                    ")]):o("p",{staticClass:"title"},[t._v("\n                        暂时没有数据！\n                    ")])])]]:o("empty-tips",{attrs:{title:"未找到您参与的项目",desc:"您可以创建自己的项目，然后针对自己的项目进行相应用户管理"}},[o("bk-button",{attrs:{"icon-left":"bk-icon icon-plus",theme:"primary"},on:{click:function(e){return t.togglePMDialog(!0)}}},[t._v("\n                新建项目\n            ")])],1)],2),t._v(" "),o("logo-dialog",{attrs:{"show-dialog":t.showlogoDialog,"to-confirm-logo":t.toConfirmLogo,"to-close-dialog":t.toCloseDialog,"file-change":t.fileChange,"selected-url":t.selectedUrl,"is-uploading":t.isUploading}})],1)};i._withStripped=!0;var a=o("/9Wh"),n=o.n(a),r=o("eR4j"),s=o.n(r),l=o("KyLU"),c=o.n(l),p=o("OBCi"),u=o.n(p),f=o("yO+b"),d=o.n(f),g=o("wv3L"),h=o.n(g),v=o("rIqr"),b=o.n(v),m=o("PSh9"),_=o.n(m),y=o("7oj+"),j=o.n(y),w=o("rIjD"),C=o.n(w),k=o("i7/w"),P=o.n(k),D=o("la05"),L=o("85Lh"),O=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("bk-dialog",{staticClass:"devops-project-logo-dialog",attrs:{width:t.width,"close-icon":!1,title:"修改LOGO","header-position":"left"},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[o("main",{staticClass:"project-logo-content"},[o("div",{staticClass:"upload-content"},[o("div",{staticClass:"upload-box"},[t.selectedUrl?o("img",{attrs:{src:t.selectedUrl}}):t._e()]),t._v(" "),o("div",{staticClass:"upload-btn"},[o("input",{staticClass:"inputfile",attrs:{id:"inputfile",type:"file",name:"file",accept:"image/png, image/jpeg"},on:{change:t.fileChange}}),t._v(" "),o("label",{attrs:{for:"file"}},[o("i",{staticClass:"bk-icon icon-bk"}),t._v("选择LOGO")]),t._v(" "),o("p",{staticClass:"logo-desc"},[t._v("\n                    只允许上传png、jpg\n                ")]),t._v(" "),o("p",{staticClass:"logo-desc"},[t._v("\n                    大小不超过2M\n                ")])])])]),t._v(" "),o("template",{slot:"footer"},[o("div",{staticClass:"bk-dialog-outer"},[o("bk-button",{attrs:{theme:"primary",disabled:t.isUploading,loading:t.isUploading},on:{click:t.toConfirmLogo}},[t._v("\n                确定\n            ")]),t._v(" "),o("bk-button",{attrs:{theme:"default",disabled:t.isUploading},on:{click:t.toCloseDialog}},[t._v("\n                取消\n            ")])],1)])],2)};O._withStripped=!0;var x,U=(x=function(t,e){return(x=C.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}x(t,e),t.prototype=null===e?j()(e):(o.prototype=e.prototype,new o)}),F=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=b()(e,o):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,o,r):a(e,o))||r);return n>3&&r&&d()(e,o,r),r},M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=640,e.curImage="",e}return U(e,t),Object.defineProperty(e.prototype,"logoDialogConf",{get:function(){return{hasHeader:!1,quickClose:!1}},enumerable:!0,configurable:!0}),F([Object(D.b)({default:!1})],e.prototype,"showDialog",void 0),F([Object(D.b)({default:!1})],e.prototype,"isUploading",void 0),F([Object(D.b)({default:""})],e.prototype,"selectedUrl",void 0),F([Object(D.b)()],e.prototype,"toConfirmLogo",void 0),F([Object(D.b)()],e.prototype,"toCloseDialog",void 0),F([Object(D.b)()],e.prototype,"fileChange",void 0),e=F([D.a],e)}(P.a),N=(o("1qeJ"),o("psIG")),B=Object(N.a)(M,O,[],!1,null,"a43b40b4",null);B.options.__file="src/components/logoDialog/index.vue";var S=B.exports,I=function(){var t=function(e,o){return(t=C.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?j()(o):(i.prototype=o.prototype,new i)}}(),R=function(){return(R=_.a||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},$=function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=b()(e,o):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,o,r):a(e,o))||r);return n>3&&r&&d()(e,o,r),r},z=function(t,e,o,i){return new(o||(o=u.a))((function(a,n){function r(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){t.done?a(t.value):new o((function(e){e(t.value)})).then(r,s)}l((i=i.apply(t,e||[])).next())}))},J=function(t,e){var o,i,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:l(0),throw:l(1),return:l(2)},"function"==typeof c.a&&(n[s.a]=function(){return this}),n;function l(n){return function(s){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,i=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=e.call(t,r)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFilterByOffline=!1,e.showlogoDialog=!1,e.isUploading=!1,e.isDataLoading=!1,e.selectedUrl="",e.curSelectProject="",e.inputValue="",e.curProjectList=[],e.curPageData=[],e.pageConf={totalPage:1,limit:15,current:1,show:!1,limitList:[10,15,20,25,30],count:0},e.matchColorList=["green","yellow","red","blue"],e}return I(e,t),Object.defineProperty(e.prototype,"formatPageData",{get:function(){return this.curPageData.map((function(t){return R({},t,{isOfflined:t.is_offlined,projectCode:t.project_code,projectName:t.project_name})}))},enumerable:!0,configurable:!0}),e.prototype.watchFilterOffline=function(t){this.filterProjectList(t)},e.prototype.watchProjects=function(t){this.initList(),this.reloadCurPage()},e.prototype.created=function(){this.initList(),this.initPageConf()},e.prototype.initList=function(){this.isDataLoading=!0,this.filterProjectList(this.isFilterByOffline),this.isDataLoading=!1},e.prototype.filterProjectList=function(t){var e=this,o=this.projectList.filter((function(t){return!0===t.is_offlined}));this.offlineProjectNum=o.length,this.curProjectList=t?this.projectList.filter((function(t){return-1!==t.project_name.indexOf(e.inputValue)&&3!==t.approval_status})):this.projectList.filter((function(t){return!1===t.is_offlined&&-1!==t.project_name.indexOf(e.inputValue)&&3!==t.approval_status})),this.initPageConf(),this.pageConf.current=1,this.curPageData=this.getDataByPage(this.pageConf.current)},e.prototype.initPageConf=function(){var t=this.curProjectList.length;t<=this.pageConf.limit?this.pageConf.show=!1:this.pageConf.show=!0,this.pageConf.count=t,this.pageConf.totalPage=Math.ceil(t/this.pageConf.limit)},e.prototype.reloadCurPage=function(){this.initPageConf(),this.pageConf.current>this.pageConf.totalPage&&(this.pageConf.current=this.pageConf.totalPage),this.curPageData=this.getDataByPage(this.pageConf.current)},e.prototype.getDataByPage=function(t){var e=(t-1)*this.pageConf.limit,o=t*this.pageConf.limit;return e<0&&(e=0),o>this.curProjectList.length&&(o=this.curProjectList.length),this.curProjectList.slice(e,o)},e.prototype.pageChange=function(t){this.pageConf.current=t;var e=this.getDataByPage(t);this.curPageData=JSON.parse(n()(e))},e.prototype.limitChange=function(t){this.pageConf.limit=t,this.pageChange(1)},e.prototype.togglePMDialog=function(t,e){void 0===e&&(e=null),this.toggleProjectDialog({showProjectDialog:t,project:e})},e.prototype.offlineProject=function(t){var e=this,o=t.is_offlined,i=t.project_id;this.curProjectData=JSON.parse(n()(t));var a=o?"确定要启用？":"确定要停用？";this.$bkInfo({title:a,confirmFn:function(){var t={id:i,data:{is_offlined:!o}};return e.updateProject(t),!0}})},e.prototype.matchForCode=function(t){var e=t.substr(0,1).charCodeAt()%4;return this.matchColorList[e]},e.prototype.modifyLogo=function(t){t.logo_addr?this.selectedUrl=t.logo_addr:this.selectedUrl="",this.showlogoDialog=!0,this.isUploading=!1,this.curSelectProject=t.project_id},e.prototype.toConfirmLogo=function(){return z(this,void 0,void 0,(function(){var t,e,o,i=this;return J(this,(function(a){switch(a.label){case 0:if(!this.selectedUrl||!this.selectedFile)return[3,6];this.isUploading=!0,(t=new FormData).append("logo",this.selectedFile[0]),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.changeProjectLogo({projectId:this.curSelectProject,formData:t})];case 2:return(e=a.sent())&&(this.$bkMessage({theme:"success",message:"LOGO修改成功！"}),this.showlogoDialog=!1,this.projectList.forEach((function(t){t.project_id===i.curSelectProject&&(t.logo_addr=e.logo_addr)}))),[3,5];case 3:return o=a.sent(),this.$bkMessage({message:o.message,theme:"error"}),this.isUploading=!1,[3,5];case 4:return this.selectedFile=void 0,[7];case 5:return[3,7];case 6:this.selectedUrl?this.showlogoDialog=!1:this.$bkMessage({message:"请选择要上传的图片",theme:"error"}),a.label=7;case 7:return this.resetUploadInput(),[2]}}))}))},e.prototype.toCloseDialog=function(){this.showlogoDialog=!1,this.selectedFile=void 0,this.resetUploadInput()},e.prototype.fileChange=function(t){var e=this,o=t.target.files[0];if(o)if("image/jpeg"!==o.type&&"image/png"!==o.type)this.$bkMessage({theme:"error",message:"请上传png、jpg格式的图片"});else if(o.size>2097152)this.$bkMessage({theme:"error",message:"请上传大小不超过2M的图片"});else{var i=new FileReader;i.readAsDataURL(o),i.onload=function(t){e.selectedUrl=i.result},this.selectedFile=t.target.files}},e.prototype.resetUploadInput=function(){this.$nextTick((function(){document.getElementById("inputfile").value=""}))},e.prototype.updateProject=function(t){return z(this,void 0,void 0,(function(){var e;return J(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.ajaxUpdatePM(t)];case 1:return o.sent(),this.$bkMessage({theme:"success",message:"项目修改成功！"}),this.togglePMDialog(!1),this.getProjects(),[3,3];case 2:return e=o.sent(),this.$bkMessage({message:e.message,theme:"error"}),[3,3];case 3:return[2]}}))}))},$([L.c],e.prototype,"projectList",void 0),$([L.c],e.prototype,"newProject",void 0),$([L.a],e.prototype,"toggleProjectDialog",void 0),$([L.a],e.prototype,"ajaxUpdatePM",void 0),$([L.a],e.prototype,"getProjects",void 0),$([L.a],e.prototype,"changeProjectLogo",void 0),$([Object(D.c)("isFilterByOffline")],e.prototype,"watchFilterOffline",null),$([Object(D.c)("projectList",{deep:!0})],e.prototype,"watchProjects",null),e=$([Object(D.a)({components:{logoDialog:S}})],e)}(P.a),E=(o("wknH"),o("k+6+"),Object(N.a)(V,i,[],!1,null,"42b08714",null));E.options.__file="src/views/ProjectManage.vue";e.default=E.exports},"k+6+":function(t,e,o){"use strict";var i=o("Jc4d");o.n(i).a},"m76+":function(t,e,o){},wknH:function(t,e,o){"use strict";var i=o("m76+");o.n(i).a}}]);