(window.webpackJsonp=window.webpackJsonp||[]).push([["credentialList"],{"/4vC":function(t,e,n){"use strict";var r=n("bXpj");n.n(r).a},"2agv":function(t,e,n){"use strict";var r=n("8Xl/"),i=n("/6KZ"),a=n("dCrc"),s=n("oICS"),o=n("Ng5M"),u=n("gou2"),c=n("ErhN"),l=n("VJcA");i(i.S+i.F*!n("Clx3")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,d,f=a(t),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,g=void 0!==v,m=0,b=l(f);if(g&&(v=r(v,h>2?arguments[2]:void 0,2)),null==b||p==Array&&o(b))for(n=new p(e=u(f.length));e>m;m++)c(n,m,g?v(f[m],m):f[m]);else for(d=b.call(f),n=new p;!(i=d.next()).done;m++)c(n,m,g?s(d,v,[i.value,m],!0):i.value);return n.length=m,n}})},"7lnb":function(t,e,n){t.exports={default:n("Vlwe"),__esModule:!0}},"80kE":function(t,e,n){"use strict";n.r(e);var r=n("Te0k"),i=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=i.a},ErhN:function(t,e,n){"use strict";var r=n("eOWL"),i=n("zJT+");t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},HGf1:function(t,e,n){},Ixaf:function(t,e,n){},Kbkl:function(t,e,n){"use strict";var r=n("HGf1");n.n(r).a},MkV0:function(t,e,n){"use strict";var r=n("Ixaf");n.n(r).a},Te0k:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{title:{type:String,default:""},desc:{type:String,default:""},btns:{type:Array,default:function(){return[]}}}}},Vlwe:function(t,e,n){n("WwSA"),n("2agv"),t.exports=n("TaGV").Array.from},VtSP:function(t,e,n){"use strict";n.r(e);var r=n("d7VB"),i=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=i.a},XJ6h:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"credential-list"},[n("inner-header",[n("template",{slot:"left"},[n("span",{staticClass:"inner-header-title"},[t._v("我的凭据")])])],2),t._v(" "),n("section",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading.isLoading,title:t.loading.title},expression:"{ isLoading: loading.isLoading, title: loading.title }"}],staticClass:"sub-view-port"},[t.showContent&&t.renderList.length?n("div",{staticClass:"table-container"},[n("bk-table",{attrs:{data:t.renderList,size:"small","show-pagination-info":!0,pagination:t.pagination},on:{"page-change":t.handlePageChange,"page-limit-change":t.handlePageCountChange}},[n("bk-table-column",{attrs:{label:"名称",prop:"credentialId"}}),t._v(" "),n("bk-table-column",{attrs:{label:"类型",prop:"credentialType",formatter:t.changeTicketType}}),t._v(" "),n("bk-table-column",{attrs:{label:"描述",prop:"credentialRemark"}}),t._v(" "),n("bk-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("bk-button",{attrs:{theme:"primary",text:"",disabled:!e.row.permissions||!e.row.permissions.edit},on:{click:function(n){return t.handleEditCredential(e.row.credentialId)}}},[t._v("编辑")]),t._v(" "),n("bk-button",{attrs:{theme:"primary",text:"",disabled:!e.row.permissions||!e.row.permissions.delete},on:{click:function(n){return t.handleDeleteCredentail(e.row.credentialId)}}},[t._v("删除")])]}}],null,!1,623086039)})],1)],1):t._e(),t._v(" "),t.showContent&&!t.renderList.length?n("empty-tips",{attrs:{title:t.tip.title,desc:t.tip.desc,btns:t.tip.btns}}):t._e()],1)],1)},i=[];r._withStripped=!0,n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},bXpj:function(t,e,n){},d7VB:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=d(n("snOE")),a=d(n("06Hw")),s=d(n("YYXh")),o=d(n("Kz1y")),u=d(n("nHZS")),c=n("WIBD"),l=d(n("wm1E"));function d(t){return t&&t.__esModule?t:{default:t}}e.default={components:{EmptyTips:l.default,"inner-header":u.default},data:function(){return{viewId:0,loading:{isLoading:!0,title:""},pagination:{count:0,limit:10,current:1},showContent:!1,credentialList:[],renderList:[],tip:{title:"暂无凭据",desc:"您可以在新增凭据中新增一个凭据",btns:[{text:"新增凭据",type:"primary",size:"normal",handler:this.addCredentialHandler}]}}},computed:(0,o.default)({},(0,c.mapState)("ticket",["ticketType"]),{projectId:function(){return this.$route.params.projectId}}),watch:{projectId:(r=(0,s.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},mounted:function(){var t=this;return(0,s.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}}),e,t)})))()},methods:{init:function(){var t=this;return(0,s.default)(a.default.mark((function e(){var n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.loading).isLoading=!0,n.title="数据加载中，请稍候";try{t.requestList()}catch(e){t.$bkMessage({message:e.message?e.message:e,theme:"error"}),console.error(e),console.error("获取凭据列表错误")}finally{setTimeout((function(){t.loading.isLoading=!1}),300)}case 4:case"end":return e.stop()}}),e,t)})))()},updateList:function(){var t,e=this.pagination,n=e.limit,r=e.current;(t=this.renderList).splice.apply(t,[0,this.renderList.length].concat((0,i.default)(this.credentialList.slice((r-1)*n,r*n))))},handlePageChange:function(t){this.pagination.current=t,this.updateList()},handlePageCountChange:function(t){this.pagination.limit=t,this.pagination.current*t>this.credentialList.length&&(this.pagination.current=1),this.updateList()},requestList:function(){var t=this;return(0,s.default)(a.default.mark((function e(){var n,r,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("ticket/requestCredentialList",{projectId:t.projectId,page:1,pageSize:1e3});case 3:r=e.sent,(n=t.credentialList).splice.apply(n,[0,t.credentialList.length].concat((0,i.default)(r.records))),t.updateList(),t.pagination.count=r.count,e.next=19;break;case 9:if(e.prev=9,e.t0=e.catch(0),403!==e.t0.code){e.next=16;break}return t.credentialList.splice(0,t.credentialList.length),t.updateList(),t.showContent=!0,e.abrupt("return");case 16:s=e.t0.message?e.t0.message:e.t0,"error",t.$bkMessage({message:s,theme:"error"});case 19:t.showContent=!0;case 20:case"end":return e.stop()}}),e,t,[[0,9]])})))()},handleDeleteCredentail:function(t){var e=this;return(0,s.default)(a.default.mark((function n(){return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.$bkInfo({title:"确认删除该凭据?",confirmFn:function(){var n=(0,s.default)(a.default.mark((function n(){var r,i;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=void 0,i=void 0,n.prev=1,n.next=4,e.$store.dispatch("ticket/toDeleteCredential",{projectId:e.projectId,id:t});case 4:r="删除凭据成功",i="success",n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),r=n.t0.message?n.t0.message:n.t0,i="error";case 12:return n.prev=12,e.$bkMessage({message:r,theme:i}),n.finish(12);case 15:e.requestList();case 16:case"end":return n.stop()}}),n,e,[[1,8,12,15]])})));return function(){return n.apply(this,arguments)}}()});case 1:case"end":return n.stop()}}),n,e)})))()},handleEditCredential:function(t){this.$router.push({name:"editCredential",params:{credentialId:t}})},changeTicketType:function(t,e,n){var r=this.ticketType.find((function(t){return t.id===n}));return r&&r.name?r.name:n},addCredentialHandler:function(){this.$router.push("createCredential")}}}},nHZS:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"inner-header clearfix"},[e("div",{staticClass:"inner-header-left"},[this._t("left")],2),this._v(" "),e("div",{staticClass:"inner-header-right"},[this._t("right")],2)])};r._withStripped=!0;n("/4vC");var i=n("psIG"),a=Object(i.a)({},r,[],!1,null,null,null);a.options.__file="src/components/devops/inner_header.vue";e.default=a.exports},neEv:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"devops-empty-tips"},[n("h2",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("p",{staticClass:"desc"},[t._v(t._s(t.desc))]),t._v(" "),n("p",{staticClass:"btns-row"},[t._t("btns",t._l(t.btns,(function(e,r){return n("button",{key:r,staticClass:"bk-button",class:["bk-"+e.type,"bk-button-"+e.size],on:{click:e.handler}},[t._v("\n                "+t._s(e.text)+"\n            ")])})))],2)])},i=[];r._withStripped=!0,n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},snOE:function(t,e,n){"use strict";e.__esModule=!0;var r,i=n("7lnb"),a=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,a.default)(t)}},wm1E:function(t,e,n){"use strict";n.r(e);var r=n("neEv"),i=n("80kE");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("MkV0");var s=n("psIG"),o=Object(s.a)(i.default,r.a,r.b,!1,null,null,null);o.options.__file="src/components/devops/emptyTips.vue",e.default=o.exports},y8L1:function(t,e,n){"use strict";n.r(e);var r=n("XJ6h"),i=n("VtSP");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("Kbkl");var s=n("psIG"),o=Object(s.a)(i.default,r.a,r.b,!1,null,null,null);o.options.__file="src/views/credential_list.vue",e.default=o.exports}}]);