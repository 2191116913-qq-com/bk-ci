(window.webpackJsonp=window.webpackJsonp||[]).push([["pipelinesView"],{"+oOb":function(e,t,i){},"/GLl":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"devops-empty-tips"},["noCollect"!==e.imgType?a("img",{staticClass:"no-data-pic",attrs:{src:e.noDataSrc,alt:""}}):e._e(),e._v(" "),"noCollect"===e.imgType?a("img",{staticClass:"no-collect-pic",attrs:{src:i("qeuZ"),alt:""}}):e._e(),e._v(" "),a("p",{staticClass:"title"},[e._v(e._s(e.title))]),e._v(" "),a("p",{staticClass:"desc"},[e._v(e._s(e.desc))]),e._v(" "),a("p",{staticClass:"btns-row"},[e._t("btns",[e.btns.length?e._l(e.btns,(function(t,i){return a("bk-button",{key:i,attrs:{disabled:e.btnDisabled,theme:t.theme,size:t.size},on:{click:t.handler}},[e._v("\n                    "+e._s(t.text)+"\n                ")])})):e._e()])],2)])},n=[];a._withStripped=!0,i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}))},"1GL7":function(e,t,i){},"2BMu":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-tag-selector staff-selector",class:{"disable-status":e.disabled}},[e.value.length||e.curInsertVal.length?e._e():i("span",{staticClass:"staff-placeholder"},[e._v(e._s(e.placeholder))]),e._v(" "),i("div",{staticClass:"select-tags",on:{click:e.toEdit}},[i("div",{ref:"selectEditor",staticClass:"select-editor"},[e._l(e.value,(function(t,a){return i("span",{key:a,staticClass:"tag-info",on:{click:function(i){return e.selectInfo(i,t)}}},[e._v(e._s(t))])})),e._v(" "),i("input",{ref:"staffInput",staticClass:"bk-tag-input form-input",attrs:{type:"text",id:"staffInput",autocomplete:"off",name:e.name},domProps:{value:e.curInsertVal},on:{input:e.input,keydown:e.keydown,paste:e.paste,blur:e.hideAll}})],2)])])},n=[];a._withStripped=!0,i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}))},Bny8:function(e,t,i){"use strict";i.r(t);var a=i("2BMu"),n=i("yfl+");for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);i("WlEA");var s=i("psIG"),l=Object(s.a)(n.default,a.a,a.b,!1,null,"116967b8",null);l.options.__file="src/components/atomFormField/UserInput/index.vue",t.default=l.exports},C4AN:function(e,t,i){"use strict";i.r(t);var a=i("y9lj"),n=i.n(a);for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);t.default=n.a},"E2+b":function(e,t,i){"use strict";var a=i("1GL7");i.n(a).a},HJb0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(i("tZmG")),n=s(i("snOE")),r=s(i("q7rD"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"user-input",mixins:[r.default],props:{name:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{curInsertVal:""}},watch:{curInsertVal:function(e){e.length&&(this.$refs.staffInput.style.width=20*e.length+"px")}},methods:{changeInputValue:function(e,t){this.curInsertVal=t},input:function(e){e.preventDefault();var t=e.target.value;this.changeInputValue(this.name,t)},paste:function(e){var t=this;e.preventDefault();var i=e.clipboardData.getData("text");try{var a=[],n=i.split(";");(n=n.filter((function(e){return e&&!t.value.includes(e)}))).forEach((function(e){a.push(e)})),a.length&&this.selectList(a,"batch")}catch(e){this.$showTips({message:e.message||e,theme:"error"})}},hideAll:function(e){e.preventDefault(),this.handleValue(e.target.value)},handleValue:function(e){var t=this;setTimeout((function(){var i=[],a=e.trim().split(",");(a=a.filter((function(e){return e&&e.trim()}))).forEach((function(e){i.push(e)})),(i=i.filter((function(e){return-1===t.value.indexOf(e)}))).length&&t.selectList(i,"batch"),t.changeInputValue(t.name,""),t.$refs.staffInput&&(t.$refs.staffInput.style.width="10px")}),100)},keydown:function(e){var t=void 0,i=e.keyCode,a=this.$refs.selectEditor.childNodes,n=this.getSiteInfo(a);switch(i){case 8:case 46:if(0!==parseInt(n.index)&&(t=n.temp[n.index-1].innerText,!this.curInsertVal.length)){this.deleteItem(this.name,n.index,t);var r=a[a.length-1];this.insertAfter(this.$refs.staffInput,r),this.$refs.staffInput.focus()}break;case 37:if(!this.curInsertVal.length){if(parseInt(n.index)>1){var s=a[parseInt(n.index)-2];this.insertAfter(this.$refs.staffInput,s),this.$refs.staffInput.value="",this.$refs.staffInput.style.width="10px"}else{var l=this.$refs.selectEditor.getElementsByTagName("span");this.$refs.selectEditor.insertBefore(this.$refs.staffInput,l[0])}this.$refs.staffInput.focus()}break;case 39:if(!this.curInsertVal.length){var o=a[parseInt(n.index)+1];this.insertAfter(this.$refs.staffInput,o),this.$refs.staffInput.focus()}break;case 13:this.handleValue(this.curInsertVal);break;case 27:this.showList=!1}},selectList:function(e,t){this.changeInputValue(this.name,e);var i=this.$refs.selectEditor.childNodes,a=this.getSiteInfo(i);this.setValue(this.name,a.index,e,t);var n=i[i.length-1];this.insertAfter(this.$refs.staffInput,n),this.$refs.staffInput.focus()},setValue:function(e,t,i,a){var r=[];r=[].concat((0,n.default)(this.value.slice(0,t)),a?(0,n.default)(i):[i],(0,n.default)(this.value.slice(t,this.value.length))),this.handleChange(this.name,r),this.changeInputValue(this.name,"")},deleteItem:function(e,t,i){var a=[].concat((0,n.default)(this.value.slice(0,t-1)),(0,n.default)(this.value.slice(t,this.value.length)));this.handleChange(this.name,a)},resetInput:function(){var e=this.$refs.selectEditor.childNodes,t=this.getSiteInfo(e);if(t.index!==t.temp.length){var i=e[e.length-1];this.insertAfter(this.$refs.staffInput,i)}},toEdit:function(e){this.$refs.staffInput.focus()},selectInfo:function(e,t){this.insertAfter(this.$refs.staffInput,e.target)},getSiteInfo:function(e){for(var t={index:0,temp:[]},i=0;i<e.length;i++){var n=e[i];(3!==n.nodeType||/\S/.test(n.nodeValue))&&t.temp.push(n)}return(0,a.default)(t.temp).forEach((function(e){"staffInput"===t.temp[e].id&&(t.index=e)})),t},insertAfter:function(e,t){var i=t.parentNode;i.lastChild===t?i.appendChild(e):i.insertBefore(e,t.nextSibling)}}}},InpW:function(e,t,i){"use strict";i.r(t);var a=i("u3AW"),n=i("uQIU");for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);i("n2pd");var s=i("psIG"),l=Object(s.a)(n.default,a.a,a.b,!1,null,null,null);l.options.__file="src/components/createViewDialog/index.vue",t.default=l.exports},JZRv:function(e,t,i){"use strict";i.r(t);var a=i("vST7"),n=i.n(a);for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);t.default=n.a},JwXn:function(e,t,i){"use strict";i.r(t);var a=i("/GLl"),n=i("JZRv");for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);i("E2+b");var s=i("psIG"),l=Object(s.a)(n.default,a.a,a.b,!1,null,null,null);l.options.__file="src/components/pipelineList/imgEmptyTips.vue",t.default=l.exports},TGZA:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading.isLoading,title:e.loading.title},expression:"{\n    isLoading: loading.isLoading,\n    title: loading.title\n}"}],staticClass:"pipeline-view-list"},[e.showContent&&e.viewList.length?[i("div",{staticClass:"view-list-content"},[i("div",{staticClass:"info-header"},[i("bk-button",{attrs:{theme:"primary"},on:{click:function(t){return e.createView()}}},[e._v("新建视图")])],1),e._v(" "),i("div",{staticClass:"view-table-wrapper"},[i("bk-table",{attrs:{data:e.viewList,size:"small"}},[i("bk-table-column",{attrs:{label:"名称",prop:"name"}}),e._v(" "),i("bk-table-column",{attrs:{label:"类型",prop:"projectId",formatter:e.showViewType}}),e._v(" "),i("bk-table-column",{attrs:{label:"描述",prop:"creator"}}),e._v(" "),i("bk-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("bk-button",{attrs:{theme:"primary",text:"",disabled:!e.isManagerUser&&t.row.projected},on:{click:function(i){return e.editView(t.row)}}},[e._v("编辑")]),e._v(" "),i("bk-button",{attrs:{theme:"primary",text:"",disabled:!e.isManagerUser&&t.row.projected},on:{click:function(i){return e.deleteView(t.row)}}},[e._v("删除")])]}}],null,!1,2132814098)})],1)],1)])]:e._e(),e._v(" "),e.showContent&&!e.viewList.length?i("empty-tips",{attrs:{title:e.emptyTipsConfig.title,desc:e.emptyTipsConfig.desc,btns:e.emptyTipsConfig.btns}}):e._e(),e._v(" "),i("create-view-dialog",{on:{updateViewList:e.requestViewList}})],2)},n=[];a._withStripped=!0,i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}))},"V/Qv":function(e,t,i){},WIKX:function(e,t,i){"use strict";var a=i("+oOb");i.n(a).a},WlEA:function(e,t,i){"use strict";var a=i("V/Qv");i.n(a).a},bXUc:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(i("06Hw")),n=c(i("YYXh")),r=c(i("snOE")),s=c(i("Kz1y")),l=i("WIBD"),o=c(i("Bny8"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={components:{UserInput:o.default},data:function(){return{isManagerUser:!0,title:"",multiSelect:!0,staffHacCheckYet:!1,groupHacCheckYet:!1,viewFilterTypeList:[{id:"filterByName",name:"流水线名称","@type":"filterByName"},{id:"filterByCreator",name:"创建人","@type":"filterByCreator"}],viewType:[{label:"个人视图",value:!1},{label:"项目视图",value:!0}],conditionList:[{label:"与",value:"AND"},{label:"或",value:"OR"}],viewDialogConfig:{loading:!1,hasFooter:!1,closeIcon:!1,quickClose:!1},viewTypeTips:{content:"项目视图仅能由项目管理员添加、编辑、删除",placements:["right"]}}},computed:(0,s.default)({},(0,l.mapGetters)({userInfo:"pipelines/getUserInfo",tagGroupList:"pipelines/getTagGroupList",showViewCreate:"pipelines/getShowViewCreate",createViewForm:"pipelines/getCreateViewForm"}),{projectId:function(){return this.$route.params.projectId}}),watch:{tagGroupList:function(e){e.map((function(e){e["@type"]="filterByLabel"})),this.viewFilterTypeList=[].concat((0,r.default)(this.viewFilterTypeList),(0,r.default)(e))},showViewCreate:function(e){if(e)if(this.createViewForm.id)this.title="编辑视图",this.requestPipelineViewDetail(this.createViewForm.id);else{this.title="新建视图";this.$store.commit("pipelines/updateViewForm",{projected:!1,name:"",logic:"AND",filters:[{id:"filterByName",name:"流水线名称","@type":"filterByName",pipelineName:""}]}),this.staffHacCheckYet=!1,this.groupHacCheckYet=!1}}},methods:{handleChange:function(e,t){var i={},a=this.createViewForm.filters[t];if("filterByName"===a.id&&"流水线名称"!==a.name)i={id:a.id,name:"流水线名称","@type":a.id,pipelineName:""},this.createViewForm.filters.splice(t,1,i);else if("filterByCreator"===a.id&&"创建人"!==a.name)i={id:a.id,name:"创建人","@type":a.id,userIds:[]},this.createViewForm.filters.splice(t,1,i);else if("filterByName"!==a.id&&"filterByCreator"!==a.id){var n=this.viewFilterTypeList.find((function(e){return e.id===a.id}));("filterByLabel"===a["@type"]&&a.name!==n.name||"filterByLabel"!==a["@type"])&&(i={id:a.id,name:n.name,"@type":"filterByLabel",groupId:a.id,labelIds:[],labels:n.labels},this.createViewForm.filters.splice(t,1,i))}},staffHandleChange:function(e,t){var i=parseInt(e.substr(4));this.createViewForm.filters.forEach((function(e,a){i===a&&(e.userIds=t)})),this.createViewForm.filters=[].concat((0,r.default)(this.createViewForm.filters))},formatForm:function(){var e=this;this.createViewForm.filters.map((function(t){if("filterByName"===t["@type"])t.name="流水线名称",t.id=t["@type"];else if("filterByCreator"===t["@type"])t.name="创建人",t.id=t["@type"];else if("filterByLabel"===t["@type"]){var i=e.viewFilterTypeList.find((function(e){return e.id===t.groupId}));t.id=i.id,t.name=i.name,t.labels=i.labels}}))},requestPipelineViewDetail:function(e){var t=this;return(0,n.default)(a.default.mark((function i(){var n,r,s;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n="",r="",i.prev=2,t.viewDialogConfig.loading=!0,i.next=6,t.$store.dispatch("pipelines/requestPipelineViewDetail",{projectId:t.projectId,viewId:e});case 6:s=i.sent,t.$store.commit("pipelines/updateViewForm",s),t.formatForm(),i.next=15;break;case 11:i.prev=11,i.t0=i.catch(2),n=i.t0.message||i.t0,r="error";case 15:return i.prev=15,t.viewDialogConfig.loading=!1,n&&t.$showTips({message:n,theme:r}),i.finish(15);case 19:case"end":return i.stop()}}),i,t,[[2,11,15,19]])})))()},addFilterItem:function(){this.createViewForm.filters.push({id:"filterByName",name:"流水线名称","@type":"filterByName",pipelineName:"",labels:[],labelIds:[]})},reduceFilterItem:function(e){this.createViewForm.filters.splice(e,1)},submitValidate:function(){var e=this,t=0;return this.createViewForm.filters.length?this.createViewForm.filters.forEach((function(i){"filterByCreator"!==i["@type"]||i.userIds.length?"filterByLabel"!==i["@type"]||i.labelIds.length||(e.groupHacCheckYet=!0,t++):(e.staffHacCheckYet=!0,t++)})):(this.$showTips({message:"视图条件不能为空",theme:"error"}),t++),!(t>0)},getParams:function(){var e={},t=this.createViewForm;return e.filters=[],e.projected=t.projected,e.name=t.name,e.logic=t.logic,t.filters.forEach((function(t){"filterByName"===t["@type"]?e.filters.push({"@type":t["@type"],condition:"LIKE",pipelineName:t.pipelineName}):"filterByCreator"===t["@type"]?e.filters.push({"@type":t["@type"],condition:"INCLUDE",userIds:t.userIds}):"filterByLabel"===t["@type"]&&e.filters.push({"@type":t["@type"],condition:"INCLUDE",groupId:t.groupId,labelIds:t.labelIds})})),e},confirmHandler:function(){var e=this;return(0,n.default)(a.default.mark((function t(){var i,n,r,s,l;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validate();case 2:if(i=t.sent,n=e.submitValidate(),!i||!n){t.next=31;break}if(r=e.getParams(),s="",l="",t.prev=8,e.viewDialogConfig.loading=!0,!e.createViewForm.id){t.next=15;break}return t.next=13,e.$store.dispatch("pipelines/editPipelineView",{projectId:e.projectId,viewId:e.createViewForm.id,params:r});case 13:t.next=17;break;case 15:return t.next=17,e.$store.dispatch("pipelines/createPipelineView",{projectId:e.projectId,params:r});case 17:s=e.createViewForm.id?"编辑成功":"新建成功",l="success",e.cancelHandler(),e.$emit("updateViewList","flag"),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(8),s=t.t0.message||t.t0,l="error";case 27:return t.prev=27,e.viewDialogConfig.loading=!1,s&&e.$showTips({message:s,theme:l}),t.finish(27);case 31:case"end":return t.stop()}}),t,e,[[8,23,27,31]])})))()},cancelHandler:function(){this.$store.commit("pipelines/toggleViewCreateDialog",!1)}}}},n2pd:function(e,t,i){"use strict";var a=i("sl9D");i.n(a).a},q7rD:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={props:{name:{type:String,required:!0},value:{type:String,required:!0,default:""},disabled:{type:Boolean,default:!1},handleChange:{type:Function,default:function(){return function(){}}},element:{type:Object,default:function(){return{}}},container:{type:Object,default:function(){return{}}},rule:{type:Object,default:function(){return{}}},component:String,required:Boolean,hasError:{type:Boolean},hidden:{type:Boolean,default:!1}},watch:{value:function(e,t){e!==t&&this.$emit("input",e)}}};t.default=a},qeuZ:function(e,t,i){e.exports=i.p+"no-collect.png?57eda0c1f2985937c97819d1b5a6fa6e"},sl9D:function(e,t,i){},tNV3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAA5CAYAAABZClfIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU1NzFFNzcxRjUzQzExRTdBMkU1QUQxMkE2RTNCRDUwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU1NzFFNzcyRjUzQzExRTdBMkU1QUQxMkE2RTNCRDUwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTU3MUU3NkZGNTNDMTFFN0EyRTVBRDEyQTZFM0JENTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTU3MUU3NzBGNTNDMTFFN0EyRTVBRDEyQTZFM0JENTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5558DUAAAHDUlEQVR42uyc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"},u3AW:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-dialog",{attrs:{width:"800","ext-cls":"create-view-dialog","show-footer":e.viewDialogConfig.hasFooter,"close-icon":e.viewDialogConfig.closeIcon},on:{confirm:e.confirmHandler,cancel:e.cancelHandler},model:{value:e.showViewCreate,callback:function(t){e.showViewCreate=t},expression:"showViewCreate"}},[[i("section",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.viewDialogConfig.loading},expression:"{\n                isLoading: viewDialogConfig.loading\n            }"}],staticClass:"create-view-content bk-form"},[i("div",{staticClass:"create-view-header"},[i("span",{staticClass:"title"},[e._v(e._s(e.title))])]),e._v(" "),i("div",{staticClass:"create-view-form"},[i("div",{staticClass:"bk-form-item is-required"},[i("label",{staticClass:"bk-label view-item-label"},[e._v("类型：")]),e._v(" "),i("div",{staticClass:"bk-form-content"},[i("bk-radio-group",{model:{value:e.createViewForm.projected,callback:function(t){e.$set(e.createViewForm,"projected",t)},expression:"createViewForm.projected"}},[i("bk-radio",{staticClass:"view-radio",attrs:{value:!1}},[e._v("个人视图")]),e._v(" "),i("bk-radio",{staticClass:"view-radio",attrs:{value:!0,disabled:!e.isManagerUser}},[e._v("项目视图"),i("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.viewTypeTips,expression:"viewTypeTips"}],staticClass:"top-start"},[i("i",{staticClass:"bk-icon icon-info-circle"})])])],1)],1)]),e._v(" "),i("div",{staticClass:"bk-form-item is-required"},[i("label",{staticClass:"bk-label view-item-label"},[e._v("标题：")]),e._v(" "),i("div",{staticClass:"bk-form-content view-item-content"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.createViewForm.name,expression:"createViewForm.name"},{name:"validate",rawName:"v-validate",value:{required:!0},expression:"{ required: true }"}],staticClass:"bk-form-input view-name-input",class:{"is-danger":e.errors.has("viewName")},attrs:{type:"text",placeholder:"请输入标题",maxlength:"15",name:"viewName","data-vv-validate-on":"blur"},domProps:{value:e.createViewForm.name},on:{input:function(t){t.target.composing||e.$set(e.createViewForm,"name",t.target.value)}}}),e._v(" "),e.errors.has("viewName")?i("div",{staticClass:"error-tips"},[e._v(e._s(e.errors.first("viewName")))]):e._e()])]),e._v(" "),i("div",{staticClass:"bk-form-item is-required"},[i("label",{staticClass:"bk-label view-item-label"},[e._v("设置视图条件：")]),e._v(" "),i("div",{staticClass:"bk-form-content"},[i("div",{staticClass:"relationship-content"},[i("label",{staticClass:"view-item-label relationship-label"},[e._v("条件间的关系：")]),e._v(" "),i("bk-radio-group",{model:{value:e.createViewForm.logic,callback:function(t){e.$set(e.createViewForm,"logic",t)},expression:"createViewForm.logic"}},e._l(e.conditionList,(function(t,a){return i("bk-radio",{key:a,staticClass:"view-radio",attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),e._v(" "),e.createViewForm.filters.length?i("table",{staticClass:"bk-table rule-list-table"},[i("thead",[i("tr",[i("th",{attrs:{width:"30%"}},[e._v("字段")]),e._v(" "),i("th",[e._v("值")]),e._v(" "),i("th",{attrs:{width:"36"}})])]),e._v(" "),i("tbody",[e._l(e.createViewForm.filters,(function(t,a){return i("tr",{key:a},[i("td",{staticClass:"indicator-item"},[i("bk-select",{on:{change:function(i){return e.handleChange(t,a)}},model:{value:t.id,callback:function(i){e.$set(t,"id",i)},expression:"row.id"}},e._l(e.viewFilterTypeList,(function(e,t){return i("bk-option",{key:t,attrs:{id:e.id,name:e.name}})})),1)],1),e._v(" "),i("td",{staticClass:"handler-item"},["filterByName"===t.id?i("section",[i("input",{directives:[{name:"validate",rawName:"v-validate",value:{required:!0},expression:"{ required: true }"},{name:"model",rawName:"v-model",value:t.pipelineName,expression:"row.pipelineName"}],staticClass:"bk-form-input input-text",class:{"is-danger":e.errors.has("item-"+a)},attrs:{type:"text",placeholder:"支持模糊匹配",maxlength:"20",name:"item-"+a,id:"pipelineName","data-vv-validate-on":"blur"},domProps:{value:t.pipelineName},on:{input:function(i){i.target.composing||e.$set(t,"pipelineName",i.target.value)}}}),e._v(" "),e.errors.has("item-"+a)?i("div",{staticClass:"error-tips"},[e._v(e._s(e.errors.first("item-"+a)))]):e._e()]):e._e(),e._v(" "),"filterByCreator"===t.id?i("section",[i("user-input",{attrs:{name:"user"+a,value:t.userIds,"handle-change":e.staffHandleChange}}),e._v(" "),e.staffHacCheckYet&&!t.userIds.length?i("div",{staticClass:"error-tips"},[e._v("创建人不能为空")]):e._e()],1):e._e(),e._v(" "),"filterByName"!==t.id&&"filterByCreator"!==t.id?i("section",[i("bk-select",{attrs:{multiple:!0},model:{value:t.labelIds,callback:function(i){e.$set(t,"labelIds",i)},expression:"row.labelIds"}},e._l(t.labels,(function(e,t){return i("bk-option",{key:t,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),e.groupHacCheckYet&&!t.labelIds.length?i("div",{staticClass:"error-tips"},[e._v("标签不能为空")]):e._e()],1):e._e()]),e._v(" "),i("td",{staticClass:"delete-handler"},[i("i",{staticClass:"bk-icon icon-minus",on:{click:function(t){return e.reduceFilterItem(a)}}})])])})),e._v(" "),i("tr",[i("td",{staticClass:"add-new-item",attrs:{colspan:"3"}},[i("span",{on:{click:function(t){return e.addFilterItem()}}},[i("i",{staticClass:"bk-icon icon-plus-circle"}),e._v("添加视图条件")])])])],2)]):e._e(),e._v(" "),e.createViewForm.filters.length?e._e():i("bk-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addFilterItem()}}},[e._v("添加视图条件")])],1)])]),e._v(" "),i("div",{staticClass:"temp-operation-bar"},[i("bk-button",{attrs:{theme:"primary"},on:{click:function(t){return e.confirmHandler()}}},[e._v("保存")]),e._v(" "),i("bk-button",{on:{click:function(t){return e.cancelHandler()}}},[e._v("取消")])],1)])]],2)},n=[];a._withStripped=!0,i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}))},uQIU:function(e,t,i){"use strict";i.r(t);var a=i("bXUc"),n=i.n(a);for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);t.default=n.a},vST7:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=i("tNV3"),r=(a=n)&&a.__esModule?a:{default:a};t.default={props:{imgType:{type:String,default:"noData"},title:{type:String,default:""},desc:{type:String,default:""},btns:{type:Array,default:function(){return[]}},btnDisabled:{type:Boolean,default:!1}},data:function(){return{noDataSrc:""}},created:function(){this.noDataSrc=r.default}}},xX7S:function(e,t,i){"use strict";i.r(t);var a=i("TGZA"),n=i("C4AN");for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);i("WIKX");var s=i("psIG"),l=Object(s.a)(n.default,a.a,a.b,!1,null,null,null);l.options.__file="src/views/list/view.vue",t.default=l.exports},y9lj:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(i("Kz1y")),n=u(i("06Hw")),r=u(i("YYXh")),s=i("WIBD"),l=u(i("JwXn")),o=u(i("InpW")),c=i("ygAv");function u(e){return e&&e.__esModule?e:{default:e}}t.default={components:{emptyTips:l.default,createViewDialog:o.default},data:function(){var e=this;return{isManagerUser:!0,showContent:!1,viewList:[],loading:{isLoading:!1,title:""},emptyTipsConfig:{title:"创建第一个视图",desc:"设置合理的视图，有助于你快速定位到自己想找的流水线",btns:[{theme:"primary",size:"normal",handler:function(){return e.createView()},text:"新建视图"}]}}},computed:{projectId:function(){return this.$route.params.projectId}},mounted:function(){var e=this;return(0,r.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:case"end":return t.stop()}}),t,e)})))()},methods:(0,a.default)({},(0,s.mapActions)("pipelines",["requestViewSettingInfo"]),(0,s.mapMutations)("pipelines",["updateViewSettingInfo"]),{init:function(){var e=this;return(0,r.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.requestGrouptLists();case 2:return t.next=4,e.requestViewList();case 4:case"end":return t.stop()}}),t,e)})))()},requestGrouptLists:function(){var e=this;return(0,r.default)(n.default.mark((function t(){var i,a;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$store,t.prev=1,t.next=4,i.dispatch("pipelines/requestGetGroupLists",{projectId:e.projectId});case 4:a=t.sent,i.commit("pipelines/updateGroupLists",a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.$showTips({message:t.t0.message||t.t0,theme:"error"});case 11:case"end":return t.stop()}}),t,e,[[1,8]])})))()},requestViewSetting:function(){var e=this;return(0,r.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.requestViewSettingInfo({projectId:e.projectId});case 3:(i=t.sent).currentViewId&&e.updateViewSettingInfo(i),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$showTips({theme:"error",message:t.t0.message||t.t0});case 10:case"end":return t.stop()}}),t,e,[[0,7]])})))()},requestViewList:function(e){var t=this;return(0,r.default)(n.default.mark((function i(){var a,r;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=t.$store,t.loading.isLoading=!0,i.prev=2,i.next=5,a.dispatch("pipelines/requestPipelineViewList",{projectId:t.projectId});case 5:if(r=i.sent,t.viewList.splice(0,t.viewList.length),r.map((function(e){t.viewList.push(e)})),!e){i.next=11;break}return i.next=11,t.requestViewSetting();case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(2),t.$showTips({message:i.t0.message||i.t0,theme:"error"});case 16:return i.prev=16,t.loading.isLoading=!1,t.showContent=!0,i.finish(16);case 20:case"end":return i.stop()}}),i,t,[[2,13,16,20]])})))()},editView:function(e){if(this.isManagerUser&&e.projected||!e.projected){var t={id:e.id,projected:!1,name:"",logic:"AND",filters:[{id:"filterByName",name:"流水线名称","@type":"filterByName",pipelineName:""}]};this.$store.commit("pipelines/updateViewForm",t),this.$store.commit("pipelines/toggleViewCreateDialog",!0)}},deletePipelineView:function(e){var t=this;return(0,r.default)(n.default.mark((function i(){var a,r,s;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=void 0,r=void 0,(s=t.loading).isLoading=!0,i.prev=3,i.next=6,t.$store.dispatch("pipelines/deletePipelineView",{projectId:t.projectId,viewId:e.id});case 6:t.requestViewList("flag"),a="删除视图成功",r="success",i.next=15;break;case 11:i.prev=11,i.t0=i.catch(3),a=i.t0.message||i.t0,r="error";case 15:return i.prev=15,a&&t.$showTips({message:a,theme:r}),s.isLoading=!1,i.finish(15);case 19:case"end":return i.stop()}}),i,t,[[3,11,15,19]])})))()},deleteView:function(e){var t=this;if(this.isManagerUser&&e.projected||!e.projected){var i="删除"+e.name;(0,c.navConfirm)({title:"确认",content:i}).then((function(){t.deletePipelineView(e)})).catch((function(){}))}},createView:function(){this.$store.commit("pipelines/updateViewForm",{type:"PERSION",title:"",condition:"VERSUS",viewFilterList:[{id:"filterByName",name:"流水线名称","@type":"filterByName",pipelineName:""}]}),this.$store.commit("pipelines/toggleViewCreateDialog",!0)},showViewType:function(e,t,i){return i?"项目视图":"个人视图"}})}},"yfl+":function(e,t,i){"use strict";i.r(t);var a=i("HJb0"),n=i.n(a);for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);t.default=n.a}}]);