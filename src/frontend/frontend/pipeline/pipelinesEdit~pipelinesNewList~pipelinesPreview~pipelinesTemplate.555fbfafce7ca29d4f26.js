(window.webpackJsonp=window.webpackJsonp||[]).push([["pipelinesEdit~pipelinesNewList~pipelinesPreview~pipelinesTemplate"],{"15pI":function(t,e,n){"use strict";var a=function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:this.size,height:this.size}},[e("use",this._b({},"use",{"xlink:href":"#"+this.name},!1))])},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},"1CGP":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,i=n("I7u8"),s=(a=i)&&a.__esModule?a:{default:a};e.default={components:{Stage:s.default},props:{editable:{type:Boolean,default:!0},isPreview:{type:Boolean,default:!1},stages:{type:Array,default:[]}},beforeDestroy:function(){window.showLinuxTipYet=!1}}},"1kG9":function(t,e,n){"use strict";n.r(e);var a=n("r1Uo"),i=n("HGO8");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("oXU7");var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,null,null);o.options.__file="src/components/Stages/index.vue",e.default=o.exports},"2BMu":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bk-tag-selector staff-selector",class:{"disable-status":t.disabled}},[t.value.length||t.curInsertVal.length?t._e():n("span",{staticClass:"staff-placeholder"},[t._v(t._s(t.placeholder))]),t._v(" "),n("div",{staticClass:"select-tags",on:{click:t.toEdit}},[n("div",{ref:"selectEditor",staticClass:"select-editor"},[t._l(t.value,(function(e,a){return n("span",{key:a,staticClass:"tag-info",on:{click:function(n){return t.selectInfo(n,e)}}},[t._v(t._s(e))])})),t._v(" "),n("input",{ref:"staffInput",staticClass:"bk-tag-input form-input",attrs:{type:"text",id:"staffInput",autocomplete:"off",name:t.name},domProps:{value:t.curInsertVal},on:{input:t.input,keydown:t.keydown,paste:t.paste,blur:t.hideAll}})],2)])])},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},"535c":function(t,e,n){"use strict";var a=n("yPI5");n.n(a).a},"5LzY":function(t,e,n){"use strict";n.r(e);var a=n("eh6r"),i=n("HWDF");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("qSlG");var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,null,null);o.options.__file="src/components/Stages/AtomList.vue",e.default=o.exports},"A/X8":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pipeline-stage"},[n("ul",{ref:"stageRef",staticClass:"soda-process-stage"},t._l(t.containers,(function(e,a){return n("stage-container",{key:a,attrs:{"stage-index":t.stageIndex,"container-index":a,"stage-length":t.stageLength,editable:t.editable,"is-preview":t.isPreview,"container-length":t.containers.length,container:e}})})),1),t._v(" "),t.editable?[t.isFirstStage?t._e():n("span",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:t.toggleAddMenu,expression:"toggleAddMenu"}],staticClass:"add-menu",on:{click:function(e){return e.stopPropagation(),t.toggleAddMenu(!t.isAddMenuShow)}}},[n("i",{class:{"add-plus-icon":!t.isAddMenuShow,"minus-icon":t.isAddMenuShow,active:t.isAddMenuShow}}),t._v(" "),t.isAddMenuShow?[n("span",{staticClass:"insert-tip direction line-add",on:{click:function(e){return e.stopPropagation(),t.showStageSelectPopup(!1)}}},[n("i",{staticClass:"tip-icon"}),t._v("\n                    插入\n                ")]),t._v(" "),n("span",{staticClass:"cruve-line left"}),t._v(" "),n("div",{staticClass:"insert-tip parallel-add",on:{click:function(e){return e.stopPropagation(),t.showStageSelectPopup(!0)}}},[n("i",{staticClass:"tip-icon"}),t._v("\n                    插入\n                ")])]:t._e()],2),t._v(" "),t.isLastStage?n("span",{staticClass:"append-stage pointer",on:{click:t.appendStage}},[n("i",{staticClass:"add-plus-icon"})]):t._e()]:t._e()],2)},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},Bny8:function(t,e,n){"use strict";n.r(e);var a=n("2BMu"),i=n("yfl+");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("WlEA");var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,"116967b8",null);o.options.__file="src/components/atomFormField/UserInput/index.vue",e.default=o.exports},DGp5:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=d(n("06Hw")),i=d(n("YYXh")),s=d(n("Kz1y")),r=d(n("QuxH")),o=n("WIBD"),u=n("ygAv"),c=d(n("Q6E5")),l=d(n("E4OK"));function d(t){return t&&t.__esModule?t:{default:t}}e.default={name:"atom-list",components:{StatusIcon:r.default,draggable:c.default,Logo:l.default},props:{container:Object,stageIndex:Number,containerIndex:Number,containerStatus:String,editable:{type:Boolean,default:!0},isPreview:{type:Boolean,default:!1}},data:function(){return{reviewLoading:!1}},computed:(0,s.default)({},(0,o.mapState)("atom",["execDetail","atomMap"]),(0,o.mapGetters)("atom",["isTriggerContainer","getElements","getStage"]),{isWaiting:function(){return"PREPARE_ENV"===this.containerStatus},userInfo:function(){return this.$userInfo},routerParams:function(){return this.$route.params},atomList:{get:function(){return this.getElements(this.container)},set:function(t){var e=this.container;(0,this.updateContainer)({container:e,newParam:{elements:t}})}},dragOptions:function(){return{ghostClass:"sortable-ghost-atom",chosenClass:"sortable-chosen-atom",animation:200,disabled:!this.editable}}}),methods:(0,s.default)({},(0,o.mapActions)("atom",["updateContainer","handleCheckAtom","requestPipelineExecDetail","togglePropertyPanel","addAtom","deleteAtom"]),{getAtomIcon:function(t){return t?document.getElementById(t)?t:"order":"placeholder"},localTime:function(t){return(0,u.coverTimer)(t)},isCurrentUser:function(t){var e=t.map((function(t){return t.trim()}));return this.userInfo&&e.indexOf(this.userInfo.username)>-1},showPropertyPanel:function(t){var e=this.stageIndex,n=this.containerIndex;this.togglePropertyPanel({isShow:!0,editingElementPos:{stageIndex:e,containerIndex:n,elementIndex:t}})},editAtom:function(t,e){var n=this.stageIndex,a=this.containerIndex,i=this.container,s=this.addAtom,r=this.deleteAtom;(e?s:r)({container:i,atomIndex:t,stageIndex:n,containerIndex:a})},handleAtomCheck:function(t,e){var n=this;return(0,i.default)(a.default.mark((function i(){var s;return a.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s={projectId:n.routerParams.projectId,pipelineId:n.routerParams.pipelineId,buildId:n.routerParams.buildNo,elementId:t,action:e},a.next=4,n.handleCheckAtom(s);case 4:!0===a.sent&&(n.$showTips({message:"ABORT"===e?"驳回成功":"审核成功",theme:"success"}),n.requestPipelineExecDetail(n.routerParams)),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),n.$showTips({message:a.t0.message||a.t0,theme:"error"});case 11:case"end":return a.stop()}}),i,n,[[0,8]])})))()},singleRetry:function(t){"string"==typeof t&&this.retryPipeline(t)},retryPipeline:function(t){var e=this;return(0,i.default)(a.default.mark((function n(){var i,s,r;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=void 0,s=void 0,n.prev=1,n.next=4,e.$store.dispatch("pipelines/requestRetryPipeline",{projectId:e.routerParams.projectId,pipelineId:e.routerParams.pipelineId,buildId:e.routerParams.buildNo,taskId:t});case 4:(r=n.sent).id?(i="重试成功",s="success",e.$router.push({name:"pipelinesDetail",params:{buildNo:r.id}}),e.requestPipelineExecDetail(e.routerParams)):(i="重试失败",s="error"),n.next=17;break;case 8:if(n.prev=8,n.t0=n.catch(1),403!==n.t0.code){n.next=15;break}return e.$showAskPermissionDialog({noPermissionList:[{resource:"流水线",option:"执行"}],applyPermissionUrl:PERM_URL_PIRFIX+"/backend/api/perm/apply/subsystem/?client_id=pipeline&project_code="+e.routerParams.projectId+"&service_code=pipeline&role_executor=pipeline:"+e.routerParams.pipelineId}),n.abrupt("return");case 15:i=n.t0.message||n.t0,s="error";case 17:return n.prev=17,i&&e.$showTips({message:i,theme:s}),n.finish(17);case 20:case"end":return n.stop()}}),n,e,[[1,8,17,20]])})))()},useSkipStyle:function(t){return t&&("SKIP"===t.status||t.additionalOptions&&!1===t.additionalOptions.enable||this.container.jobControlOption&&!1===this.container.jobControlOption.enable)}})}},E4OK:function(t,e,n){"use strict";n.r(e);var a=n("15pI"),i=n("UfR3");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,null,null);o.options.__file="src/components/Logo/index.vue",e.default=o.exports},HGO8:function(t,e,n){"use strict";n.r(e);var a=n("1CGP"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},HJb0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(n("tZmG")),i=r(n("snOE")),s=r(n("q7rD"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={name:"user-input",mixins:[s.default],props:{name:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{curInsertVal:""}},watch:{curInsertVal:function(t){t.length&&(this.$refs.staffInput.style.width=20*t.length+"px")}},methods:{changeInputValue:function(t,e){this.curInsertVal=e},input:function(t){t.preventDefault();var e=t.target.value;this.changeInputValue(this.name,e)},paste:function(t){var e=this;t.preventDefault();var n=t.clipboardData.getData("text");try{var a=[],i=n.split(";");(i=i.filter((function(t){return t&&!e.value.includes(t)}))).forEach((function(t){a.push(t)})),a.length&&this.selectList(a,"batch")}catch(t){this.$showTips({message:t.message||t,theme:"error"})}},hideAll:function(t){t.preventDefault(),this.handleValue(t.target.value)},handleValue:function(t){var e=this;setTimeout((function(){var n=[],a=t.trim().split(",");(a=a.filter((function(t){return t&&t.trim()}))).forEach((function(t){n.push(t)})),(n=n.filter((function(t){return-1===e.value.indexOf(t)}))).length&&e.selectList(n,"batch"),e.changeInputValue(e.name,""),e.$refs.staffInput&&(e.$refs.staffInput.style.width="10px")}),100)},keydown:function(t){var e=void 0,n=t.keyCode,a=this.$refs.selectEditor.childNodes,i=this.getSiteInfo(a);switch(n){case 8:case 46:if(0!==parseInt(i.index)&&(e=i.temp[i.index-1].innerText,!this.curInsertVal.length)){this.deleteItem(this.name,i.index,e);var s=a[a.length-1];this.insertAfter(this.$refs.staffInput,s),this.$refs.staffInput.focus()}break;case 37:if(!this.curInsertVal.length){if(parseInt(i.index)>1){var r=a[parseInt(i.index)-2];this.insertAfter(this.$refs.staffInput,r),this.$refs.staffInput.value="",this.$refs.staffInput.style.width="10px"}else{var o=this.$refs.selectEditor.getElementsByTagName("span");this.$refs.selectEditor.insertBefore(this.$refs.staffInput,o[0])}this.$refs.staffInput.focus()}break;case 39:if(!this.curInsertVal.length){var u=a[parseInt(i.index)+1];this.insertAfter(this.$refs.staffInput,u),this.$refs.staffInput.focus()}break;case 13:this.handleValue(this.curInsertVal);break;case 27:this.showList=!1}},selectList:function(t,e){this.changeInputValue(this.name,t);var n=this.$refs.selectEditor.childNodes,a=this.getSiteInfo(n);this.setValue(this.name,a.index,t,e);var i=n[n.length-1];this.insertAfter(this.$refs.staffInput,i),this.$refs.staffInput.focus()},setValue:function(t,e,n,a){var s=[];s=[].concat((0,i.default)(this.value.slice(0,e)),a?(0,i.default)(n):[n],(0,i.default)(this.value.slice(e,this.value.length))),this.handleChange(this.name,s),this.changeInputValue(this.name,"")},deleteItem:function(t,e,n){var a=[].concat((0,i.default)(this.value.slice(0,e-1)),(0,i.default)(this.value.slice(e,this.value.length)));this.handleChange(this.name,a)},resetInput:function(){var t=this.$refs.selectEditor.childNodes,e=this.getSiteInfo(t);if(e.index!==e.temp.length){var n=t[t.length-1];this.insertAfter(this.$refs.staffInput,n)}},toEdit:function(t){this.$refs.staffInput.focus()},selectInfo:function(t,e){this.insertAfter(this.$refs.staffInput,t.target)},getSiteInfo:function(t){for(var e={index:0,temp:[]},n=0;n<t.length;n++){var i=t[n];(3!==i.nodeType||/\S/.test(i.nodeValue))&&e.temp.push(i)}return(0,a.default)(e.temp).forEach((function(t){"staffInput"===e.temp[t].id&&(e.index=t)})),e},insertAfter:function(t,e){var n=e.parentNode;n.lastChild===e?n.appendChild(t):n.insertBefore(t,e.nextSibling)}}}},HWDF:function(t,e,n){"use strict";n.r(e);var a=n("DGp5"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},I7u8:function(t,e,n){"use strict";n.r(e);var a=n("A/X8"),i=n("lPuA");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("U5+p");var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,null,null);o.options.__file="src/components/Stages/Stage.vue",e.default=o.exports},L7i6:function(t,e,n){"use strict";var a=n("WaYU");n.n(a).a},OrOA:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"svg-logo",props:{name:String,size:{type:[String,Number],default:24}}}},QMMY:function(t,e,n){},QuxH:function(t,e,n){"use strict";n.r(e);var a=n("o+lK"),i=n("Yyzj");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("L7i6");var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,null,null);o.options.__file="src/components/Stages/StatusIcon.vue",e.default=o.exports},"Rv+a":function(t,e,n){"use strict";n.r(e);var a=n("unRz"),i=n("nUQc");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("535c");var r=n("psIG"),o=Object(r.a)(i.default,a.a,a.b,!1,null,null,null);o.options.__file="src/components/Stages/StageContainer.vue",e.default=o.exports},"U5+p":function(t,e,n){"use strict";var a=n("QMMY");n.n(a).a},UfR3:function(t,e,n){"use strict";n.r(e);var a=n("OrOA"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},"V/Qv":function(t,e,n){},VyPk:function(t,e,n){},WaYU:function(t,e,n){},WlEA:function(t,e,n){"use strict";var a=n("V/Qv");n.n(a).a},YiFe:function(t,e,n){},Yyzj:function(t,e,n){"use strict";n.r(e);var a=n("tPz6"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},eh6r:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("draggable",{staticClass:"container-atom-list",class:{"trigger-container":t.isTriggerContainer(t.container),readonly:!t.editable},attrs:{options:t.dragOptions},model:{value:t.atomList,callback:function(e){t.atomList=e},expression:"atomList"}},[t._l(t.atomList,(function(e,a){var i,s;return n("li",{key:e.name,class:(i={"atom-item":!0},i[e.status]=e.status,i),on:{click:function(e){return t.showPropertyPanel(a)}}},[n("section",{staticClass:"atom-item atom-section normal-atom",class:(s={},s[e.status]=e.status,s["is-error"]=e.isError,s["template-compare-atom"]=e.templateModify,s)},[e.status&&"SKIP"!==e.status?n("status-icon",{attrs:{type:"element",status:e.status}}):t.isWaiting&&"SKIP"!==e.status?n("status-icon",{attrs:{type:"element",status:"WAITING"}}):t.atomMap[e.atomCode]&&t.atomMap[e.atomCode].icon?n("img",{class:{"atom-icon":!0,"skip-icon":t.useSkipStyle(e)},attrs:{src:t.atomMap[e.atomCode].icon}}):n("logo",{class:{"atom-icon":!0,"skip-icon":t.useSkipStyle(e)},attrs:{name:t.getAtomIcon(e.atomCode),size:"18"}}),t._v(" "),n("span",{staticClass:"atom-name",class:{"skip-name":t.useSkipStyle(e)},attrs:{title:e.name}},[t._v(t._s(e.atomCode?e.name:"待选择插件"))]),t._v(" "),"REVIEWING"===e.status&&t.userInfo&&t.isCurrentUser(e.reviewUsers)?n("span",{staticClass:"atom-reviewing-tips",on:{click:function(n){return n.stopPropagation(),t.handleAtomCheck(e.id,"PROCESS")}}},[t._v("继续")]):t._e(),t._v(" "),"REVIEWING"===e.status&&t.userInfo&&t.isCurrentUser(e.reviewUsers)?n("span",{staticClass:"atom-reviewing-tips",on:{click:function(n){return n.stopPropagation(),t.handleAtomCheck(e.id,"ABORT")}}},[t._v("驳回")]):t._e(),t._v(" "),"REVIEWING"===e.status&&t.userInfo&&!t.isCurrentUser(e.reviewUsers)?n("bk-popover",{attrs:{placement:"top"}},[n("span",{staticClass:"atom-review-diasbled-tips"},[t._v("继续")]),t._v(" "),n("template",{slot:"content"},[n("p",[t._v("无权限进行此操作,审核人为"+t._s(e.reviewUsers.join(",")))])])],2):t._e(),t._v(" "),"REVIEWING"===e.status&&t.userInfo&&!t.isCurrentUser(e.reviewUsers)?n("bk-popover",{attrs:{placement:"top"}},[n("span",{staticClass:"atom-review-diasbled-tips"},[t._v("驳回")]),t._v(" "),n("template",{slot:"content"},[n("p",[t._v("无权限进行此操作,审核人为"+t._s(e.reviewUsers.join(",")))])])],2):t._e(),t._v(" "),"REVIEW_ABORT"===e.status?n("bk-popover",{attrs:{placement:"top"}},[n("span",{staticClass:"atom-review-diasbled-tips"},[t._v("已驳回")]),t._v(" "),n("template",{slot:"content"},[n("p",[t._v("审核未通过，审核人为"+t._s(t.execDetail.cancelUserId||e.reviewUsers))])])],2):t._e(),t._v(" "),e.elapsed<36e5&&"SKIP"!==e.status?n("span",{class:"SUCCEED"===e.status?"atom-success-timer":"REVIEW_ABORT"===e.status?"atom-warning-timer":"atom-fail-timer"},[e.canRetry?n("a",{staticClass:"atom-single-retry",attrs:{href:"javascript: void(0);"},on:{click:function(n){return n.stopPropagation(),t.singleRetry(e.id)}}},[t._v("重试")]):[t._v("\n                    "+t._s(void 0!==e.elapsed?t.localTime(e.elapsed):"")+"\n                ")]],2):t._e(),t._v(" "),e.elapsed>=36e5?n("bk-popover",{attrs:{placement:"top"}},[n("span",{class:"SUCCEED"===e.status?"atom-success-timer":"REVIEW_ABORT"===e.status?"atom-warning-timer":"atom-fail-timer"},[t._v(">1h")]),t._v(" "),n("template",{slot:"content"},[n("p",[t._v(t._s(e.elapsed?t.localTime(e.elapsed):""))])])],2):t._e(),t._v(" "),t.editable?n("i",{staticClass:"add-plus-icon close",on:{click:function(e){return e.stopPropagation(),t.editAtom(a,!1)}}}):t._e(),t._v(" "),t.editable&&e.isError?n("i",{staticClass:"bk-icon icon-exclamation-triangle-shape"}):t._e(),t._v(" "),t.isPreview&&t.container["@type"].indexOf("trigger")<0?n("bk-checkbox",{staticClass:"atom-canskip-checkbox",attrs:{disabled:t.useSkipStyle(e)},on:{click:function(t){t.stopPropagation()}},model:{value:e.canElementSkip,callback:function(n){t.$set(e,"canElementSkip",n)},expression:"atom.canElementSkip"}}):t._e()],1)])})),t._v(" "),t.editable?n("span",{class:{"add-atom-entry":!0,"block-add-entry":0===t.atomList.length},on:{click:function(e){return t.editAtom(t.atomList.length-1,!0)}}},[n("i",{staticClass:"add-plus-icon"}),t._v(" "),0===t.atomList.length?n("span",[t._v("添加插件")]):t._e()]):t._e()],2)},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},gQGC:function(t,e,n){"use strict";n.r(e);var a=n("yScV"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},gfAY:function(t,e,n){"use strict";var a=n("VyPk");n.n(a).a},jtfD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o(n("Kz1y")),i=n("WIBD"),s=o(n("Rv+a")),r=n("ygAv");function o(t){return t&&t.__esModule?t:{default:t}}e.default={components:{StageContainer:s.default},props:{containers:{type:Array,default:[]},stageIndex:Number,stageLength:Number,editable:{type:Boolean,default:!0},isPreview:{type:Boolean,default:!1}},data:function(){return{isAddMenuShow:!1}},computed:(0,a.default)({},(0,i.mapState)("atom",["insertStageIndex"]),{isFirstStage:function(){return 0===this.stageIndex},isLastStage:function(){return this.stageIndex===this.stageLength-1}}),mounted:function(){this.updateHeight()},updated:function(){this.updateHeight()},methods:(0,a.default)({},(0,i.mapActions)("atom",["setInertStageIndex","toggleStageSelectPopup"]),{appendStage:function(){var t=this.stageIndex,e=this.setInertStageIndex,n=this.showStageSelectPopup;e({insertStageIndex:t+1}),n(!1)},showStageSelectPopup:function(t){this.toggleStageSelectPopup({isStagePopupShow:!0,isAddParallelContainer:t})},toggleAddMenu:function(t){var e=this.stageIndex,n=this.setInertStageIndex;this.isAddMenuShow="boolean"==typeof t&&t,this.isAddMenuShow&&n({insertStageIndex:e})},updateHeight:function(){var t=this.$refs.stageRef.parentElement,e=t.querySelector(".cruve-line"),n=t.querySelector(".parallel-add"),a=(0,r.getOuterHeight)(this.$refs.stageRef);e&&(e.style.height=a+"px"),n&&(n.style.top=a+10+"px")}})}},kaYn:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=d(n("7lnb")),i=d(n("Kz1y")),s=n("WIBD"),r=n("ygAv"),o=d(n("qzqJ")),u=d(n("5LzY")),c=d(n("BdbJ")),l=d(n("QuxH"));function d(t){return t&&t.__esModule?t:{default:t}}e.default={components:{StatusIcon:l.default,ContainerType:o.default,AtomList:u.default,showTooltip:c.default},props:{container:Object,stageIndex:Number,containerIndex:Number,stageLength:Number,containerLength:Number,editable:{type:Boolean,default:!0},isPreview:{type:Boolean,default:!1}},data:function(){return{showContainerName:!1,showAtomName:!1}},computed:(0,i.default)({},(0,s.mapState)("atom",["execDetail"]),(0,s.mapGetters)("atom",["isTriggerContainer","isDockerBuildResource","getAllContainers"]),{showCheckedToatal:function(){var t=this.isTriggerContainer,e=this.container;return this.$route.path.indexOf("preview")>0&&!t(e)},containerSerialNum:function(){return this.stageIndex+1+"-"+(this.containerIndex+1)},isOnlyOneContainer:function(){return 1===this.containerLength},projectId:function(){return this.$route.params.projectId},containerDisabled:function(){return!(!this.container.jobControlOption||!1!==this.container.jobControlOption.enable)},containerTooltipConfig:function(){var t=void 0,e=void 0;switch(!0){case this.isTriggerContainer(this.container):t="build_trigger",e="点击构建触发可配置推荐版本号、流水线变量"}return!this.isPreview&&t?{name:t,content:e,key:t}:{}}}),watch:{"container.elements.length":function(t,e){t!==e&&this.$forceUpdate()},"container.runContainer":function(t){var e=this.container,n=this.updateContainer,a=e.elements;this.containerDisabled||(a.filter((function(t){return void 0===t.additionalOptions||t.additionalOptions.enable})).map((function(e){return e.canElementSkip=t,!1})),n({container:e,newParam:{elements:a}}))}},mounted:function(){this.updateCruveConnectHeight(),this.containerDisabled&&(this.container.runContainer=!1)},updated:function(){this.updateCruveConnectHeight()},methods:(0,i.default)({},(0,s.mapActions)("atom",["togglePropertyPanel","addAtom","deleteAtom","updateContainer"]),{updateCruveConnectHeight:function(){if(this.$refs.stageContainer){var t=(0,r.getOuterHeight)(this.$refs.stageContainer)-12+"px";(0,a.default)(this.$refs.stageContainer.querySelectorAll(".connect-line")).map((function(e){e.style.height=t}))}},showContainerPanel:function(){var t=this.stageIndex,e=this.containerIndex;this.togglePropertyPanel({isShow:!0,editingElementPos:{stageIndex:t,containerIndex:e}})}})}},lPuA:function(t,e,n){"use strict";n.r(e);var a=n("jtfD"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},nUQc:function(t,e,n){"use strict";n.r(e);var a=n("kaYn"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a},"o+lK":function(t,e,n){"use strict";var a=function(){var t,e=this,n=e.$createElement,a=e._self._c||n;return a("span",{class:(t={"stage-status":!0},t[e.type]=e.type,t.readonly=!e.editable||e.jobOption&&!1===e.jobOption.enable,t)},[a("transition",{attrs:{name:"slide-top"}},["RUNNING"===e.status||"PREPARE_ENV"===e.status||"QUEUE"===e.status||"LOOP_WAITING"===e.status||"CALL_WAITING"===e.status?a("i",{staticClass:"bk-icon icon-circle-2-1 executing-job"}):e._e()]),e._v(" "),a("transition",{attrs:{name:"slide-top"}},["WAITING"===e.status?a("i",{staticClass:"bk-icon icon-clock"}):e._e()]),e._v(" "),a("transition",{attrs:{name:"slide-down"}},["CANCELED"===e.status?a("i",{staticClass:"bk-icon warning icon-exclamation-circle-shape"}):e._e()]),e._v(" "),a("transition",{attrs:{name:"slide-down"}},["REVIEWING"===e.status||"REVIEW_ABORT"===e.status?a("i",{staticClass:"bk-icon warning icon-exclamation-triangle-shape"}):e._e()]),e._v(" "),a("transition",{attrs:{name:"slide-left"}},["FAILED"===e.status||"HEARTBEAT_TIMEOUT"===e.status||"QUEUE_TIMEOUT"===e.status||"EXEC_TIMEOUT"===e.status?a("i",{staticClass:"bk-icon danger icon-close-circle-shape"}):e._e()]),e._v(" "),a("transition",{attrs:{name:"slide-right"}},["SUCCEED"===e.status?a("i",{staticClass:"bk-icon success icon-check-circle-shape"}):e._e()]),e._v(" "),e.status&&"SKIP"!==e.status?e._e():e._t("default")],2)},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},oXU7:function(t,e,n){"use strict";var a=n("YiFe");n.n(a).a},q36d:function(t,e,n){},qSlG:function(t,e,n){"use strict";var a=n("q36d");n.n(a).a},qzqJ:function(t,e,n){"use strict";n.r(e);var a=n("gQGC");for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("gfAY");var s=n("psIG"),r=Object(s.a)(a.default,void 0,void 0,!1,null,null,null);r.options.__file="src/components/Stages/ContainerType.vue",e.default=r.exports},r1Uo:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition-group",{staticClass:"soda-stage-list",attrs:{name:"list",tag:"div"}},t._l(t.stages,(function(e,a){return n("Stage",{key:a,staticClass:"list-item",attrs:{editable:t.editable,"is-preview":t.isPreview,"stage-index":a,"stage-length":t.stages.length,containers:e.containers}})})),1)},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},tPz6:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"stage-status",props:{status:String,type:String,editable:Boolean,serialNum:String,jobOption:Object}}},unRz:function(t,e,n){"use strict";var a=function(){var t,e=this,n=e.$createElement,a=e._self._c||n;return a("div",{ref:"stageContainer",class:{"soda-stage-container":!0,"first-container":0===e.stageIndex,readonly:!e.editable||e.containerDisabled}},[e.isOnlyOneContainer||e.containerLength-1===e.containerIndex?e._e():[a("span",{staticClass:"connect-line left",class:{cruve:0===e.containerIndex}}),e._v(" "),a("span",{staticClass:"connect-line right",class:{cruve:0===e.containerIndex}})],e._v(" "),a("show-tooltip",e._b({attrs:{placement:"bottom"}},"show-tooltip",e.containerTooltipConfig,!1),[a("h3",{class:(t={"container-title":!0,"first-ctitle":0===e.containerIndex},t[e.container.status]=e.container.status,t),on:{click:e.showContainerPanel}},[a("status-icon",{attrs:{type:"container",editable:e.editable,"job-option":e.container.jobControlOption,status:e.container.status}},[e._v("\n                "+e._s(e.containerSerialNum)+"\n            ")]),e._v(" "),a("p",{staticClass:"container-name",attrs:{title:e.container.name}},[a("span",[e._v(e._s("PREPARE_ENV"===e.container.status?"准备构建环境中":e.container.name))])]),e._v(" "),e.showCheckedToatal?e._e():a("container-type",{attrs:{container:e.container}}),e._v(" "),e.showCheckedToatal?a("bk-checkbox",{staticClass:"atom-canskip-checkbox",attrs:{disabled:e.containerDisabled},on:{click:function(t){t.stopPropagation()}},model:{value:e.container.runContainer,callback:function(t){e.$set(e.container,"runContainer",t)},expression:"container.runContainer"}}):e._e(),e._v(" "),e.showDebugBtn?a("bk-button",{staticClass:"debug-btn",attrs:{theme:"warning"},on:{click:function(t){return t.stopPropagation(),e.debugDocker(t)}}},[e._v("登录调试")]):e._e()],1)]),e._v(" "),a("atom-list",{attrs:{container:e.container,editable:e.editable,"is-preview":e.isPreview,"stage-index":e.stageIndex,"container-index":e.containerIndex,"container-status":e.container.status}})],2)},i=[];a._withStripped=!0,n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}))},yPI5:function(t,e,n){},yScV:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,i=n("Kz1y"),s=(a=i)&&a.__esModule?a:{default:a},r=n("WIBD"),o=n("ygAv");e.default={name:"container-type",props:{container:Object},computed:(0,s.default)({},(0,r.mapGetters)("atom",["isVmContainer","isNormalContainer","isTriggerContainer"]),{icon:function(){var t=this.$createElement,e=this.container,n=this.isVmContainer,a=this.isNormalContainer,i=this.isTriggerContainer,s=this.convertElapsed,r=e.vmNames,u=void 0===r?[]:r,c=e.baseOS,l=void 0===c?"":c,d=e.elements,f=void 0===d?[]:d,p={};switch(!0){case void 0!==e.systemElapsed||void 0!==e.elementElapsed:var h=s(e.systemElapsed),m=s(e.elementElapsed),v=h+m,g=v<36e5;return t("i",{directives:[{name:"bk-tooltips",value:{content:"用户耗时："+(0,o.convertMStoString)(m)+" + 系统耗时： "+(0,o.convertMStoString)(h)}}]},[g?(0,o.coverTimer)(v):">1h"]);case e.isError:p={class:"bk-icon icon-exclamation-triangle-shape is-danger"};break;case n(e):p={class:"bk-icon icon-"+l.toLowerCase(),title:u.join(",")};break;case a(e):p={class:"bk-icon icon-none"};break;case i(e):return t("i",[f.length,"个"])}return t("i",p)}}),methods:{convertElapsed:function(t){return void 0===t?0:parseInt(t)}},render:function(t){return t("span",{class:"container-type"},[this.icon])}}},"yfl+":function(t,e,n){"use strict";n.r(e);var a=n("HJb0"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e.default=i.a}}]);